// @ts-nocheck
/**
 * Meter Model for PostgreSQL
 * Extends BaseModel for automatic CRUD generation
 * 
 * Generated from database schema
 */

const BaseModel = require('../../../../framework/backend/api/base/BaseModel');
const db = require('../config/database');

class Meter extends BaseModel {
  constructor(meterData = {}) {
    super(meterData);
    
    // Field definitions only - CRUD methods are generated by BaseModel
    this.id = meterData.id;
    this.name = meterData.name;
    this.type = meterData.type;
    this.serial_number = meterData.serial_number;
    this.installation_date = meterData.installation_date;
    this.device_id = meterData.device_id;
    this.location_id = meterData.location_id;
    this.ip = meterData.ip;
    this.port = meterData.port;
    this.protocol = meterData.protocol;
    this.status = meterData.status;
    this.next_maintenance = meterData.next_maintenance;
    this.last_maintenance = meterData.last_maintenance;
    this.maintenance_interval = meterData.maintenance_interval;
    this.maintenance_notes = meterData.maintenance_notes;
    this.register_map = meterData.register_map;
    this.notes = meterData.notes;
    this.active = meterData.active;
    this.created_at = meterData.created_at;
    this.updated_at = meterData.updated_at;
  }

  // ===== Static Configuration =====
  
  /**
   * Database table name
   */
  static get tableName() {
    return 'meter';
  }

  /**
   * Primary key field
   */
  static get primaryKey() {
    return 'id';
  }

  /**
   * Relationship definitions
   * TODO: Add relationships based on foreign keys
   */
  static get relationships() {
    return {
      // Example:
      // parentTable: {
      //   type: 'belongsTo',
      //   model: 'ParentModel',
      //   foreignKey: 'parent_id',
      //   targetKey: 'id'
      // }
    };
  }

  // ===== Custom Methods =====

  /**
   * Get meter statistics
   */
  static async getStats() {
    const query = `
      SELECT
        COUNT(*) as total_count
      FROM meter
    `;

    const result = await db.query(query);
    return result.rows[0];
  }

  /**
   * Convert to JSON
   */
  toJSON() {
    return {
      ...this
    };
  }
}

module.exports = Meter;
